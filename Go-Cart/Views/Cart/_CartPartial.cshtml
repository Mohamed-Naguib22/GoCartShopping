@model Cart

<h1>Shopping Cart</h1>

@foreach (var product in Model.Products)
{
    <div class="row mt-5 align-items-center">
        <div class="col-md-2">
            <img src="@product.ImgUrl" class="cartimg" alt="">
        </div>
        <div class="col-md-3">
            <h5>@product.Name</h5>
            <p>@product.Category</p>
        </div>
        <div class="col-md-2">
            <select @(product.Colors.Any() ? "" : "disabled") class="my-2 form-select text-black" onchange="setItemColor(this, @product.Id)" aria-label="Default select example">
                <option selected>Color</option>
                @foreach (var color in product.Colors)
                {
                    <option value="@color">@color</option>
                }
            </select>
            <select @(product.Sizes.Any() ? "" : "disabled") class="my-2 form-select text-black" onchange="setItemSize(this, @product.Id)" aria-label="Default select example">
                <option selected>Size</option>
                @foreach (var size in product.Sizes)
                {
                    <option value="@size">@size</option>
                }
            </select>
        </div>
        <div class="col-md-2">
            <div class="Product-amount border d-flex p-0 align-items-center">
                <button data-product-id="@product.Id" class="minus p-0 text-center py-2 border-end fs-5 fw-bold">-</button>
                <div class="amount p-0 text-center py-2 fs-6">@product.Quantity</div>
                <button data-product-id="@product.Id" class="positive p-0 text-center py-2 border-start fs-5 fw-bold">+</button>
            </div>
        </div>
        <div class=" col-md-2">
            <span class="h2 cartprice">@product.Price$</span>
        </div>
        <div class=" col-md-1">
            <button id="remove-cart" class="btn btn-danger" type="submit" data-product-id="@product.Id">X</button>
        </div>
    </div>
}
<script>
    function setItemColor(selectElement, productId) {
        var selectedColor = selectElement.value;
        $.ajax({
            url: '/Cart/SetItemColor',
            type: 'POST',
            data: { productId: productId, color: selectedColor },
            success: function () {
            },
            error: function () {
            }
        });
    }
    function setItemSize(selectElement, productId) {
        var selectedSize = selectElement.value;
        $.ajax({
            url: '/Cart/SetItemSize',
            type: 'POST',
            data: { productId: productId, size: selectedSize },
            success: function () {
            },
            error: function () {
            }
        });
    }
</script>